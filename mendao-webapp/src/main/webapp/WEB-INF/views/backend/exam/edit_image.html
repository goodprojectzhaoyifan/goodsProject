<form name="editImage" th:action="@{/backend/exam/edit/image}" method="post" >
	<input type="hidden" name="id" th:value="${id}" />
	<div class="row">
		<div class="col-lg-3">
		   	<label class="thumbnail">
		   		<img id="imgIcon" th:src="@{${cdn} + ${icon}}" alt="通用的占位符缩略图" />
		   		<input type="hidden" name="icon" th:value="${icon}" id="icon" />
		   	</label>
		</div>
		<div class="col-lg-3">
		   	<label class="thumbnail">
		   		<img id="imgImage" th:src="@{${cdn} + ${image}}" alt="通用的占位符缩略图" />
		   		<input type="hidden" name="image" th:value="${image}" id="image" />
		   	</label>
	   	</div>
	</div>
	<div class="row">
	   	<div class="col-lg-3 caption">
		   	<p>
		      列表缩略图<input value="选择图片" type="button" class="btn" id="btnUpload0" />
		   </p>
		</div>
		<div class="col-lg-3 caption">
		   	<p>
		      测评页面图片<input value="选择图片" type="button" class="btn" id="btnUpload1" />
		   </p>
		</div>
	</div>
	<div class="col-lg-12">
		<input type="submit" class="btn btn-primary" value="提交" />
	</div>
</form>
<script th:inline="javascript">
/*<![CDATA[*/
//KindEditor.ready(function(K) {
	var uploadbutton0 = KindEditor.uploadbutton({
		button : KindEditor('#btnUpload0')[0],
		fieldName : 'imgFile',
		url : /*[[@{'/upload/upimage/?dir=image'}]]*/,
		afterUpload : function(data) {
			if (data.error === 0) {
				var refer = this.button;
				$("#imgIcon").attr("src", data.url);
				$('#icon').val(data.path);
			} else {
				alert(data.message);
			}
		},
		afterError : function(str) {
			alert('自定义错误信息: ' + str);
		}
	});
	uploadbutton0.fileBox.change(function(e) {
		uploadbutton0.submit();
	});
	
	var uploadbutton1 = KindEditor.uploadbutton({
		button : KindEditor('#btnUpload1')[0],
		fieldName : 'imgFile',
		url : /*[[@{'/upload/upimage/?dir=image'}]]*/,
		afterUpload : function(data) {
			if (data.error === 0) {
				var refer = this.button;
				$("#imgImage").attr("src", data.url);//.html("<img src='"+ data.url +"' />").show();
				$('#image').val(data.path);
			} else {
				alert(data.message);
			}
		},
		afterError : function(str) {
			alert('自定义错误信息: ' + str);
		}
	});
	uploadbutton1.fileBox.change(function(e) {
		uploadbutton1.submit();
	});
	
	$('form[name=editImage]').submit(function(){
		var $form = $(this);
		$.post($form.attr('action'), $form.serialize(), function(data){
			alert('保存成功');
			$('#content').html(data);
		});
		return false;
	});
//});
/*]]>*/
</script>